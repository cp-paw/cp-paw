#!/bin/bash
export THISDIR=$(pwd)
export RC1=0
export RC2=0
export RC3=0
#
#-------------------------------------------------------------------------------
#--  install cp-paw package                                                   --
#-------------------------------------------------------------------------------
#  options for paw_build,sh
#  -c choice 
#     defaultparmfile sets PARALLEL to true, when option choice
#     contains substring "parallel".
#     defaultparmfile names the install directory bin/$CHOICE} per default.
#  -f parmfile (normally omitted)
#  -s suffix (this parameter overwrites the value given by the parmfile)
#     the executable is named [p]paw_${SUFFIX}.x
#  -z suppress documentation
#  -v verbose
#  
#-------------------------------------------------------------------------------
echo "======================== building dbg  =================================="
src/Buildtools/paw_build.sh -v -j10 -c dbg           \
                            1>out_dbg 2>&1 ; RC1=$? &
echo "======================== building fast==================================="
src/Buildtools/paw_build.sh -v -j10 -c fast -z   \
                            1>out_fast 2>&1 ; RC2=$? &
echo "======================== building fast_parallel ========================="
src/Buildtools/paw_build.sh -v -j10 -c fast_parallel -z  \
                            1>out_fastp 2>&1 ; RC3=$? &
wait
if [[ $RC1 != 0 || $RC2 != 0 || $RC3 != 0 ]] ; then
  echo "-------------------------------------------------------------------" >&2
  echo "error in $0: installation failed " >&2
  echo "RC1=$RC1, RC2=$RC2, RC2=$RC3"      >&2
  echo "shutting down $0"                  >&2
  echo "-------------------------------------------------------------------" >&2
  exit 1
fi
#
#
echo " "
echo "-------------------------------------------------------------------------"
echo "-----------------------paw_install finished------------------------------"
echo "-------------------------------------------------------------------------"
echo "ensure that the following lines are in your profile (e.g. ~/.profile, ~/.bashrc, ~/.zprofile, or similar):"
echo " "
echo "export PAWDIR=$(pwd)"
echo "export PATH=\${PAWDIR}/bin/fast:\${PAWDIR}/bin/fast_parallel:\${PAWDIR}/bin/dbg:\${PATH}"
echo "-------------------------------------------------------------------------"
echo " "
#
