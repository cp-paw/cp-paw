#
SHELL=/bin/sh
#
#########################################################################
##                                                                     ##
##  make a paw executable and a paw library using gmake                ##
##  ===================================================                ##
##                                                                     ##
#########################################################################
##                                                                     ##
##  Primary targets:                                                   ##
##                                                                     ##
##  directory structure                                                ##
##    @PAWDIR@/bin/@ARCH@       executables                            ##
##    @PAWDIR@/bin/@ARCH@/none  objects with simple compiler flags     ##
##    @PAWDIR@/bin/@ARCH@/fast  optimized objects                      ##
##    @PAWDIR@/bin/@ARCH@/prof  objects for profiling                  ##
##    @PAWDIR@/bin/@ARCH@/dbg   objects for debugging                  ##
##    @PAWDIR@/src              sources for CP-PAW main code           ##
##    @PAWDIR@/src/Tools        directory containing Tools             ##
##    @PAWDIR@/src/F90PP        directory preprocessor etc             ##
##                                                                     ##
#########################################################################
## The following block of variables is set by the configure            ##
## script (AC_SUBST @...@ and sed-Commands var...)                     ##
#########################################################################
#
#___________________________ the hardware architecture
ARCH=@ARCH@
#___________________________ root directory of the PAW distribution
PAWDIR=@PAWDIR@
#___________________________ object type (none,fast,dbg,prof)
OBJTYPE=varOBJTYPE
#___________________________ path to the source files
SRCDIR=${PAWDIR}/src
#___________________________ path to the object files
OBJDIR=${PAWDIR}/bin/${ARCH}/Objects/${OBJTYPE}
#___________________________ path to the binaries
BINDIR=${PAWDIR}/bin/${ARCH}
#___________________________ path to the tool-directory
TOOLDIR=${PAWDIR}/src/Tools
#___________________________ directory with blas library
BLASDIR=@BLASDIR@
#___________________________ directory with lapack library
LAPACKDIR=@LAPACKDIR@
#___________________________ directory with fft library
FFTDIR=@FFTDIR@
#___________________________ directory with MPI library
MPIDIR=@MPIDIR@
#___________________________header file for fft
FFT_HEADER=@FFT_HEADER@
#___________________________header file for MPI
MPI_HEADER=@MPI_HEADER@
#___________________________special treatment
SPECIAL=@SPECIAL@
#___________________________ set to T, if this is Makefile.parallel 
PARALLEL=varPARALLEL
#___________________________ Fortran90 compiler + compiler flags 
ifeq (${PARALLEL},T)   
  COMPILE=@COMPILE_PARALLEL@
  LINK=@LINK_PARALLEL@
  LIBS=@LIBS_PARALLEL@
  F90PP=${BINDIR}/f90pp @CPPVAR@ -DCPPVARIABLE_PARALLEL 
else
  COMPILE=@COMPILE_SCALAR@
  LINK=@LINK_SCALAR@
  LIBS=@LIBS_SCALAR@
  F90PP=${BINDIR}/f90pp @CPPVAR@
endif
#___________________________ the PAW-binary (inclusive path)
PAWX=@PAWX@
#___________________________ the extension of files to be compiled
FEXT=@FEXT@
#___________________________ the GNU make utility
MAKE=@MAKE@
#
##########################################################################
##  define parameters                                                   ##
##########################################################################
ifeq (${PARALLEL},T)   #select parallel versus scalar paw_mpelib.f90
  MODE=_p
else
  MODE=_s
endif
ifeq (${SPECIAL},IBM)
  POE_PREFIX=poe
  POE_SUFFIX=-proc 1 -nodes 1 -rmpool 0
else
  POE_PREFIX=
  POE_SUFFIX=
endif
#
# out of the file src/paw_mpelib.f a parallel _p and
# a sequential _s version are produced
#
MPE = ${OBJDIR}/paw_mpelib$(MODE).o
#
##########################################################################
##  include files                                                       ##
##########################################################################
#
# fftw_f77.i is an include file for the FFTW-library
# in case FFTW is linked, this file has to be copied into the 
# object directory
# 
ifneq ($(strip ${FFT_HEADER}),) 
  # copy includefile into object directory. 
  # new name is uppercase to allow global uppercasing of fortran code
  FFTWINCLUDE=cp ${FFT_HEADER} ${OBJDIR}/fftw_f77.i
else
  # not there, just create an empty file
  FFTWINCLUDE= touch ${OBJDIR}/fftw_f77.i
endif
#
# mpif.h is an include file for the MPICH-library
# for parallel compilation, this file has to be copied into
# the object directory. Not needed for IBM environment
# the include file is usually named mpif.f90
#
ifeq (${PARALLEL},T)   #select parallel versus scalar paw_mpelib.f90
  ifneq ($(strip ${MPI_HEADER}),) 
    # copy includefile into object directory
    MPIINCLUDE=cp ${MPI_HEADER} ${OBJDIR}/mpif.h
  else
    # not there, just create an empty file
    MPIINCLUDE= touch ${OBJDIR}/mpif.h
  endif
else
  # not needed, just create an empty file to fool dependencies
  MPIINCLUDE= touch ${OBJDIR}/mpif.h
endif
#
# paw_mpelib.f holds the subroutines necessary for parallel execution
# of the code. Via preprocessor variables, this source is split up into
# two files, one for parallel and one for sequential execution. ($MODE is
# defined in the if-statement above)
# libpaw.a holds the object files and can be linked to any code which 
# needs a PAW subroutine (leave the # after libpaw.a)
# MPE   = ${OBJDIR}/paw_mpelib$(MODE).o
PAWLIB= ${OBJDIR}/libpaw.a#         
#
#########################################################################
## Definition of the targets                                           ##
#########################################################################
default: ${PAWX}
#
clean:
	find ${OBJDIR}/* -maxdepth 0 \! -name Makefile -exec rm {} \;
	rm -f ${PAWX}
#
##########################################################################
##  define object files kept in the library                             ##
##########################################################################
#
LOBJS = \
        ${OBJDIR}/paw_trace.o \
        ${OBJDIR}/paw_error.o \
        ${OBJDIR}/paw_filehandler.o \
        ${OBJDIR}/paw_clock.o \
        ${OBJDIR}/paw_lock.o \
        ${OBJDIR}/paw_timing.o \
        ${OBJDIR}/paw_linkedlist.o \
        ${OBJDIR}/paw_strings.o \
        ${OBJDIR}/paw_dft.o \
        ${OBJDIR}/paw_dftaddendum.o \
        ${OBJDIR}/paw_constants.o \
        ${OBJDIR}/paw_spherical.o \
        ${OBJDIR}/paw_generalpurpose.o \
        ${OBJDIR}/paw_report.o \
        ${OBJDIR}/paw_periodictable.o \
        ${OBJDIR}/paw_radial.o \
        ${OBJDIR}/paw_schroedinger.o \
        ${OBJDIR}/paw_specialfunctions.o \
        ${OBJDIR}/paw_usage.o \
        ${OBJDIR}/paw_selftest.o \
        ${OBJDIR}/paw_strcio.o \
        ${OBJDIR}/paw_cell.o \
        ${OBJDIR}/paw_pdos.o \
        ${OBJDIR}/paw_library.o \
        ${OBJDIR}/paw_polynom.o \
        ${OBJDIR}/paw_dimer.o  \
        ${OBJDIR}/paw_debug.o
#
##########################################################################
##  define other objects                                                ##
##########################################################################
#
OBJECTS1 = \
           ${OBJDIR}/paw_thermostat.o \
           ${OBJDIR}/paw_isolate.o \
           ${OBJDIR}/paw_assist.o \
           ${OBJDIR}/paw_ldaplusu.o \
           ${OBJDIR}/paw_lists.o \
           ${OBJDIR}/paw_constraints.o \
           ${OBJDIR}/paw_fft.o \
#
OBJECTS2 = \
           ${OBJDIR}/paw_augmentation.o \
           ${OBJDIR}/paw_softcore.o \
           ${OBJDIR}/paw_classical.o \
           ${OBJDIR}/paw_forcefield.o \
           ${OBJDIR}/paw_atoms.o \
           ${OBJDIR}/paw.o \
           ${OBJDIR}/paw_efg.o \
           ${OBJDIR}/paw_ioroutines.o \
           ${OBJDIR}/paw_iotra.o \
           ${OBJDIR}/paw_ionew.o \
           ${OBJDIR}/paw_qmmm.o \
           ${OBJDIR}/paw_cosmo.o \
           ${OBJDIR}/paw_warmup.o \
           ${OBJDIR}/paw_optfric.o 
#  the following is for the QMMM of Woo and Margl
#          ${OBJDIR}/mm_paw_modules.o \
#          ${OBJDIR}/mm_paw_core_mm.o \
#          ${OBJDIR}/mm_paw_interface.o
#          ${OBJDIR}/paw_md
#
OBJECTS3 = \
           ${OBJDIR}/paw_setups.o \
           ${OBJDIR}/paw_setupread.o \
           ${OBJDIR}/paw_potential.o \
           ${OBJDIR}/paw_occupations.o \
           ${OBJDIR}/paw_brillouin.o \
           ${OBJDIR}/paw_pairpotential.o \
           ${OBJDIR}/paw_graphics.o \
           ${OBJDIR}/paw_waves1.o \
           ${OBJDIR}/paw_waves2.o \
           ${OBJDIR}/paw_mixer.o \
           ${OBJDIR}/paw_cg.o \
           ${OBJDIR}/paw_kpoints.o \
           ${OBJDIR}/paw_vext.o \
           ${OBJDIR}/paw_vdw.o 
#           ${OBJDIR}/paw_pdos.o 
#          ${OBJDIR}/paw_optic.o \
#
OBJECTS= ${OBJECTS1} ${OBJECTS2} ${OBJECTS3} 
# 
#
# Definition of objects for the compilation of the PAW-tools
#
# Objects for atomic setup tool
OBJNEWATOM = \
          ${OBJDIR}/paw_newatom.o 
# Objects for atomic setup tool
OBJATOM = \
          ${OBJDIR}/paw_diffgl.o \
          ${OBJDIR}/paw_oldradial.o \
          ${OBJDIR}/paw_atom.o 
# Objects for paw_tra.x
OBJTRA =  \
          ${OBJDIR}/paw_tra.o 
# Objects for paw_wave.x
OBJWAVE=  \
          ${OBJDIR}/paw_wave.o
# Objects for paw_1davpot.x
OBJ1DAVPOT=  \
          ${OBJDIR}/paw_1davpot.o
# Objects for paw_cmcwave.x
OBJCMCWAVE=  \
          ${OBJDIR}/paw_cmcwave.o
# Objects for paw_grab.x
OBJGRAB=  \
          ${OBJDIR}/paw_grab.o
# Objects for paw_dos.x
OBJDOS=  \
          ${OBJDIR}/paw_dos.o
# Objects for paw_preopt.x
OBJPRE=  \
          ${OBJDIR}/paw_preopt.o 
# Objects for paw_converttra.x
OBJCONVERTTRA=  \
          ${OBJDIR}/paw_converttra.o
# Objects for paw_cleantra.x
OBJCLEANTRA=  \
          ${OBJDIR}/paw_cleantra.o
# Objects for paw_strc.x
OBJSTRC=  \
          ${OBJDIR}/paw_strc.o
# Objects for paw_toxyz.x
OBJTOXYZ=  \
          ${OBJDIR}/paw_toxyz.o
# Objects for paw_tostrc.x
OBJTOSTRC=  \
          ${OBJDIR}/paw_tostrc.o


#########################################################################
##  create preprocessor                                                ##
#########################################################################
f90pp: ${BINDIR}/f90pp_tmplts.x  ${OBJDIR}/version_writeparmfile.o
${BINDIR}/f90pp_tmplts.x: ${SRCDIR}/F90PP/f90pp_tmplts.f90
	${F90PP} -notemplates ${SRCDIR}/F90PP/f90pp_tmplts.f90 > ${OBJDIR}/f90pp_tmplts_d.${FEXT} 
	${COMPILE} -o ${OBJDIR}/f90pp_tmplts.o ${OBJDIR}/f90pp_tmplts_d.${FEXT}
	${LINK} -o ${BINDIR}/f90pp_tmplts.x ${OBJDIR}/f90pp_tmplts.o ${LIBS}

${OBJDIR}/version_writeparmfile.o: ${BINDIR}/parmfilewriter.x 
	cat ${PAWDIR}/parms.in_use | ${POE_PREFIX} ${BINDIR}/parmfilewriter.x ${POE_SUFFIX} >  ${OBJDIR}/version_writeparmfile.${FEXT}
	${F90PP} -notemplates ${OBJDIR}/version_writeparmfile.${FEXT}> ${OBJDIR}/version_writeparmfile_d.${FEXT} 
	${COMPILE} -o ${OBJDIR}/version_writeparmfile.o ${OBJDIR}/version_writeparmfile_d.${FEXT}

${BINDIR}/parmfilewriter.x: ${SRCDIR}/F90PP/parmfilewriter.f90
	${F90PP} -notemplates ${SRCDIR}/F90PP/parmfilewriter.f90 > ${OBJDIR}/parmfilewriter_d.${FEXT} 
	${COMPILE} -o ${OBJDIR}/parmfilewriter.o ${OBJDIR}/parmfilewriter_d.${FEXT}
	${LINK} -o ${BINDIR}/parmfilewriter.x ${OBJDIR}/parmfilewriter.o ${LIBS}
#
#########################################################################
##  link files and produce executable PAWX                             ##
#########################################################################
#
${PAWX} : f90pp ${OBJDIR}/fftw_f77.i ${OBJDIR}/mpif.h ${LOBJS} \
                ${OBJDIR}/version_writeparmfile.o \
                ${OBJECTS} ${MPE} 
	${LINK} -o ${PAWX} ${OBJECTS} ${LOBJS} ${OBJDIR}/version_writeparmfile.o ${MPE} ${LIBS}
#
#########################################################################
##  build paw library                                                  ##
#########################################################################
${PAWLIB}: ${LOBJS} ${MPE} ${OBJDIR}/version_writeparmfile.o 
	ar -ru $(PAWLIB) $(LOBJS) ${OBJDIR}/paw_mpelib_s.o ${OBJDIR}/version_writeparmfile.o
#
#########################################################################
##  build Tools                                                        ##
#########################################################################
#
${BINDIR}/paw_newatom.x: ${OBJNEWATOM} ${PAWLIB} ${OBJDIR}/paw_setupread.o 
	${LINK} -o ${BINDIR}/paw_newatom.x ${OBJNEWATOM} ${OBJDIR}/paw_setupread.o -lpaw ${LIBS} 
#
clean_newatom:
	rm -f ${OBJNEWATOM} ${BINDIR}/paw_newatom.x
#
${BINDIR}/paw_atom.x: ${OBJATOM} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_atom.x ${OBJATOM} -lpaw ${LIBS} 
#
clean_atom:
	rm -f ${OBJATOM}; rm -f ${BINDIR}/paw_atom.x
#
${BINDIR}/paw_tra.x: ${OBJTRA} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_tra.x ${OBJTRA} ${OBJDIR}/paw_forcefield.o ${OBJDIR}/paw_classical.o -lpaw ${LIBS} 
#
clean_tra:
	rm -f ${OBTRA}; rm -f ${BINDIR}/paw_tra.x
#
${BINDIR}/paw_wave.x: ${OBJWAVE} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_wave.x ${OBJWAVE} -lpaw ${LIBS} 
#
clean_wave:
	rm -f ${OBJWAVE}; rm -f ${BINDIR}/paw_wave.x
#
${BINDIR}/paw_1davpot.x: ${OBJ1DAVPOT} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_1davpot.x ${OBJ1DAVPOT} -lpaw ${LIBS} 
#
clean_1davpot:
	rm -f ${OBJ1DAVPOT}; rm -f ${BINDIR}/paw_1davpot.x
#
${BINDIR}/paw_cmcwave.x: ${OBJCMCWAVE} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_cmcwave.x ${OBJCMCWAVE} -lpaw ${LIBS} 
#
clean_cmcwave:
	rm -f ${OBJCMCWAVE}; rm -f ${BINDIR}/paw_cmcwave.x
#
${BINDIR}/paw_grab.x: ${OBJGRAB} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_grab.x ${OBJGRAB} -lpaw ${LIBS} 
#
clean_grab:
	rm -f ${OBJGRAB}; rm -f ${BINDIR}/paw_grab.x
#
${BINDIR}/paw_dos.x: ${OBJDOS} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_dos.x ${OBJDOS} -lpaw ${LIBS} 
#
clean_dos:
	rm -f ${OBJDOS}; rm -f ${BINDIR}/paw_dos.x
#
${BINDIR}/paw_preopt.x: ${OBJPRE} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_preopt.x ${OBJPRE}  ${OBJDIR}/paw_forcefield.o ${OBJDIR}/paw_classical.o -lpaw ${LIBS}
#
clean_preopt:
	rm -f ${OBJPRE}; rm -f ${BINDIR}/paw_preopt.x
#
${BINDIR}/paw_converttra.x: ${OBJCONVERTTRA} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_converttra.x ${OBJCONVERTTRA} -lpaw ${LIBS} 
#
clean_converttra:
	rm -f ${OBJCONVERTTRA}; rm -f ${BINDIR}/paw_converttra.x
#
${BINDIR}/paw_cleantra.x: ${OBJCLEANTRA} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_cleantra.x ${OBJCLEANTRA} -lpaw ${LIBS} 
#
clean_cleantra:
	rm -f ${OBJCLEANTRA}; rm -f ${BINDIR}/paw_cleantra.x
#
${BINDIR}/paw_strc.x: ${OBJSTRC} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_strc.x ${OBJSTRC} -lpaw ${LIBS} 
#
clean_strc:
	rm -f ${OBJSTRC}; rm -f ${BINDIR}/paw_strc.x
#
${BINDIR}/paw_toxyz.x: ${OBJTOXYZ} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_toxyz.x ${OBJTOXYZ} -lpaw ${LIBS} 
#
clean_toxyz:
	rm -f ${OBJTOXYZ}; rm -f ${BINDIR}/paw_toxyz.x
#
${BINDIR}/paw_tostrc.x: ${OBJTOSTRC} ${PAWLIB}
	${LINK} -o ${BINDIR}/paw_tostrc.x ${OBJTOSTRC} -lpaw ${LIBS} 
#
clean_tostrc:
	rm -f ${OBJTOSTRC}; rm -f ${BINDIR}/paw_tostrc.x
#
# copy include files if necessary (controlled by if-statements above)
#
${OBJDIR}/fftw_f77.i:
	${FFTWINCLUDE}
#
${OBJDIR}/mpif.h:
	${MPIINCLUDE}
#
#${OBJDIR}/mm_paw_f77.o 
#########################################################################
##  compile code files independent of parameter                        ##
##  and place the objects in OBJDIR                                    ##
#########################################################################
#
#__special rule for parallel interface because of preprocessor___________
${MPE} : ${OBJDIR}/%$(MODE).o: ${SRCDIR}/%.f90 ${OBJDIR}/mpif.h
	${F90PP} $< >${OBJDIR}/$*$(MODE)_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*$(MODE)_d.${FEXT}
#
#__general rule for object files_________________________________________
$(OBJECTS) $(LOBJS): ${OBJDIR}/%.o: ${SRCDIR}/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
#__compile the tools____________________________________________________
#
${OBJNEWATOM}: ${OBJDIR}/%.o : ${TOOLDIR}/Atomnew/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJATOM}: ${OBJDIR}/%.o : ${TOOLDIR}/Atom/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJTRA}: ${OBJDIR}/%.o : ${TOOLDIR}/Tra/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJWAVE}: ${OBJDIR}/%.o : ${TOOLDIR}/Wave/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJ1DAVPOT}: ${OBJDIR}/%.o : ${TOOLDIR}/Wave/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJCMCWAVE}: ${OBJDIR}/%.o : ${TOOLDIR}/Wave/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJGRAB}: ${OBJDIR}/%.o : ${TOOLDIR}/Grab/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJDOS}: ${OBJDIR}/%.o : ${TOOLDIR}/PDoS/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJPRE}: ${OBJDIR}/%.o : ${TOOLDIR}/Preopt/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJCONVERTTRA}: ${OBJDIR}/%.o : ${TOOLDIR}/Tra/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJCLEANTRA}: ${OBJDIR}/%.o : ${TOOLDIR}/Tra/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJSTRC}: ${OBJDIR}/%.o : ${TOOLDIR}/Strc/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJTOXYZ}: ${OBJDIR}/%.o : ${TOOLDIR}/Strc/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#
${OBJTOSTRC}: ${OBJDIR}/%.o : ${TOOLDIR}/Strc/%.f90
	${F90PP} $< >${OBJDIR}/$*_d.${FEXT}
	${COMPILE} -o $@ ${OBJDIR}/$*_d.${FEXT}
#########################################################################
##  include dependencies through mod files                             ##
#########################################################################
ifeq ($(ALLDEP),T)
 ${OBJDIR}/paw_filehandler.o:   ${OBJDIR}/paw_strings.o
 ${OBJDIR}/paw_linkedlist.o:    ${OBJDIR}/paw_strings.o
 ${OBJDIR}/paw_periodictable.o: ${OBJDIR}/paw_strings.o
 ${OBJDIR}/paw_ioroutines.o:    ${OBJDIR}/paw_strings.o
 ${OBJDIR}/paw_trace.o:         ${OBJDIR}/paw_strings.o
#
 ${OBJDIR}/paw_timing.o:        ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_linkedlist.o:    ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_report.o:        ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_waves1.o:        ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_waves2.o:        ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_augmentation.o:  ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw.o:               ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_constraints.o:   ${OBJDIR}/paw_mpelib${MODE}.o 
 ${OBJDIR}/paw_potential.o:     ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_pairpotential.o: ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_isolate.o:       ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_qmmm.o:          ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_thermostat.o:    ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_occupations.o:   ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_ionew.o:         ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_atoms.o:         ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_classical.o:     ${OBJDIR}/paw_mpelib${MODE}.o
 ${OBJDIR}/paw_thermostat.o:    ${OBJDIR}/paw_mpelib${MODE}.o 
 ${OBJDIR}/paw_debug.o:         ${OBJDIR}/paw_mpelib${MODE}.o 
 ${OBJDIR}/paw_debug.o:          ${OBJDIR}/paw_waves1.o 
 ${OBJDIR}/paw_debug.o:          ${OBJDIR}/paw_waves2.o 

 ${OBJDIR}/paw_dimer.o:         ${OBJDIR}/paw_mpelib${MODE}.o 


 ${OBJDIR}/paw_ldaplusu.o:      ${OBJDIR}/paw_periodictable.o
 ${OBJDIR}/paw_ioroutines.o:    ${OBJDIR}/paw_periodictable.o

 ${OBJDIR}/paw_ioroutines.o:    ${OBJDIR}/paw_linkedlist.o
 ${OBJDIR}/paw_constraints.o:   ${OBJDIR}/paw_linkedlist.o
 ${OBJDIR}/paw_occupations.o:   ${OBJDIR}/paw_linkedlist.o
 ${OBJDIR}/paw_waves1.o:        ${OBJDIR}/paw_linkedlist.o
 ${OBJDIR}/paw_waves2.o:        ${OBJDIR}/paw_linkedlist.o
 ${OBJDIR}/paw_efg.o:           ${OBJDIR}/paw_linkedlist.o

 ${OBJDIR}/paw_atoms.o:         ${OBJDIR}/paw_report.o
 ${OBJDIR}/paw_ionew.o:         ${OBJDIR}/paw_report.o
 ${OBJDIR}/paw_occupations.o:   ${OBJDIR}/paw_report.o
 ${OBJDIR}/paw_qmmm.o:          ${OBJDIR}/paw_report.o
 ${OBJDIR}/paw_classical.o:     ${OBJDIR}/paw_report.o
 ${OBJDIR}/paw_thermostat.o:    ${OBJDIR}/paw_report.o

 ${OBJDIR}/paw_ioroutines.o:    ${OBJDIR}/paw_clock.o 
 ${OBJDIR}/paw_ionew.o:         ${OBJDIR}/paw_waves1.o
 ${OBJDIR}/paw_ionew.o:         ${OBJDIR}/paw_waves2.o

 ${OBJDIR}/paw_waves2.o:        ${OBJDIR}/paw_waves1.o

 ${OBJDIR}/paw_cg.o:               ${OBJDIR}/paw_waves1.o

 ${OBJDIR}/paw_ioroutines.o:    ${OBJDIR}/paw_forcefield.o
# ${OBJDIR}/paw_optic.o:		${OBJDIR}/paw_fft.o
# ${OBJDIR}/paw_optic.o:		${OBJDIR}/paw_waves.o
 ${OBJDIR}/paw_qmmm.o:          ${OBJDIR}/paw_report.o

 ${OBJDIR}/paw_library.o:      ${OBJDIR}/fftw_f77.i
endif
##########################################################################
#== machine-generated dependencies
###########################################################################
 dials_module.mod : ${OBJDIR}/paw_assist.o                                                                                       
 autopilot_module.mod : ${OBJDIR}/paw_assist.o                                                                                   
 ${OBJDIR}/paw_atoms.o : mpe_module.mod                                                                                          
 ${OBJDIR}/paw_atoms.o : restart_interface.mod                                                                                   
 atoms_module.mod : ${OBJDIR}/paw_atoms.o                                                                                        
 ${OBJDIR}/paw_augmentation.o : mpe_module.mod                                                                                   
 augmentation_module.mod : ${OBJDIR}/paw_augmentation.o                                                                          
 expertnal1cpot_module.mod : ${OBJDIR}/paw_augmentation.o                                                                        
 brillouin_module.mod : ${OBJDIR}/paw_brillouin.o                                                                                
 ${OBJDIR}/paw_cell.o : restart_interface.mod                                                                                    
 ${OBJDIR}/paw_cell.o : mpe_module.mod                                                                                           
 cell_module.mod : ${OBJDIR}/paw_cell.o                                                                                          
 ${OBJDIR}/paw_cg.o : waves_module.mod                                                                                           
 ${OBJDIR}/paw_cg.o : mpe_module.mod                                                                                             
 cg_interface_module.mod : ${OBJDIR}/paw_cg.o                                                                                    
 ${OBJDIR}/paw_classical.o : mpe_module.mod                                                                                      
 ${OBJDIR}/paw_classical.o : periodictable_module.mod                                                                            
 classical_module.mod : ${OBJDIR}/paw_classical.o                                                                                
 ufftable_module.mod : ${OBJDIR}/paw_classical.o                                                                                 
 clock_module.mod : ${OBJDIR}/paw_clock.o                                                                                        
 constants_module.mod : ${OBJDIR}/paw_constants.o                                                                                
 ${OBJDIR}/paw_constraints.o : linkedlist_module.mod                                                                             
 ${OBJDIR}/paw_constraints.o : mpe_module.mod                                                                                    
 constraints_module.mod : ${OBJDIR}/paw_constraints.o                                                                            
 symmetrize_module.mod : ${OBJDIR}/paw_constraints.o                                                                             
 ${OBJDIR}/paw_cosmo.o : restart_interface.mod                                                                                   
 ${OBJDIR}/paw_cosmo.o : mpe_module.mod                                                                                          
 ${OBJDIR}/paw_cosmo.o : periodictable_module.mod                                                                                
 cosmo_module.mod : ${OBJDIR}/paw_cosmo.o                                                                                        
 ${OBJDIR}/paw_debug.o : mpe_module.mod                                                                                          
 ${OBJDIR}/paw_debug.o : waves_module.mod                                                                                        
 debug_module.mod : ${OBJDIR}/paw_debug.o                                                                                        
 newdft_module.mod : ${OBJDIR}/paw_dftaddendum.o                                                                                 
 dft_module.mod : ${OBJDIR}/paw_dft.o                                                                                            
 table1d_module.mod : ${OBJDIR}/paw_dft.o                                                                                        
 exchange_module.mod : ${OBJDIR}/paw_dft.o                                                                                       
 perdewzunger_module.mod : ${OBJDIR}/paw_dft.o                                                                                   
 barthhedin_module.mod : ${OBJDIR}/paw_dft.o                                                                                     
 perdew_module.mod : ${OBJDIR}/paw_dft.o                                                                                         
 perdewwang91l_module.mod : ${OBJDIR}/paw_dft.o                                                                                  
 perdewwang91g_module.mod : ${OBJDIR}/paw_dft.o                                                                                  
 pbe_module.mod : ${OBJDIR}/paw_dft.o                                                                                            
 lyp88_module.mod : ${OBJDIR}/paw_dft.o                                                                                          
 ${OBJDIR}/paw_dimer.o : strings_module.mod                                                                                      
 ${OBJDIR}/paw_dimer.o : mpe_module.mod                                                                                          
 dimer_module.mod : ${OBJDIR}/paw_dimer.o                                                                                        
 dimer_oscillator_module.mod : ${OBJDIR}/paw_dimer.o                                                                             
 ${OBJDIR}/paw_efg.o : linkedlist_module.mod                                                                                     
 ${OBJDIR}/paw_efg.o : mpe_module.mod                                                                                            
 hyperfine_module.mod : ${OBJDIR}/paw_efg.o                                                                                      
 error_module.mod : ${OBJDIR}/paw_error.o                                                                                        
 ${OBJDIR}/paw.o : clock_module.mod                                                                                              
 ${OBJDIR}/paw.o : mpe_module.mod                                                                                                
 version_module.mod : ${OBJDIR}/paw.o                                                                                            
 timestep_module.mod : ${OBJDIR}/paw.o                                                                                           
 stopit_module.mod : ${OBJDIR}/paw.o                                                                                             
 ${OBJDIR}/paw_fft.o : mpe_module.mod                                                                                            
 planewave_module.mod : ${OBJDIR}/paw_fft.o                                                                                      
 ${OBJDIR}/paw_filehandler.o : strings_module.mod                                                                                
 filehandler_module.mod : ${OBJDIR}/paw_filehandler.o                                                                            
 ${OBJDIR}/paw_forcefield.o : strings_module.mod                                                                                 
 ${OBJDIR}/paw_forcefield.o : linkedlist_module.mod                                                                              
 ${OBJDIR}/paw_forcefield.o : classical_module.mod                                                                               
 forcefield_module.mod : ${OBJDIR}/paw_forcefield.o                                                                              
 sort_module.mod : ${OBJDIR}/paw_generalpurpose.o                                                                                
 ${OBJDIR}/paw_graphics.o : mpe_module.mod                                                                                       
 graphics_module.mod : ${OBJDIR}/paw_graphics.o                                                                                  
 ${OBJDIR}/paw_ionew.o : restart_interface.mod                                                                                   
 ${OBJDIR}/paw_ionew.o : mpe_module.mod                                                                                          
 ${OBJDIR}/paw_ionew.o : strings_module.mod                                                                                      
 ${OBJDIR}/paw_ionew.o : timestep_module.mod                                                                                     
 ${OBJDIR}/paw_ioroutines.o : linkedlist_module.mod                                                                              
 ${OBJDIR}/paw_ioroutines.o : clock_module.mod                                                                                   
 ${OBJDIR}/paw_ioroutines.o : version_module.mod                                                                                 
 ${OBJDIR}/paw_ioroutines.o : strings_module.mod                                                                                 
 ${OBJDIR}/paw_ioroutines.o : mpe_module.mod                                                                                     
 ${OBJDIR}/paw_ioroutines.o : periodictable_module.mod                                                                           
 ${OBJDIR}/paw_ioroutines.o : forcefield_module.mod                                                                              
 io_module.mod : ${OBJDIR}/paw_ioroutines.o                                                                                      
 trajectoryio_module.mod : ${OBJDIR}/paw_iotra.o                                                                                 
 ${OBJDIR}/paw_isolate.o : mpe_module.mod                                                                                        
 isolate_module.mod : ${OBJDIR}/paw_isolate.o                                                                                    
 ldaplusu_module.mod : ${OBJDIR}/paw_ldaplusu.o                                                                                  
 random_module.mod : ${OBJDIR}/paw_library.o                                                                                     
 ${OBJDIR}/paw_linkedlist.o : strings_module.mod                                                                                 
 ${OBJDIR}/paw_linkedlist.o : mpe_module.mod                                                                                     
 llist_module.mod : ${OBJDIR}/paw_linkedlist.o                                                                                   
 linkedlist_module.mod : ${OBJDIR}/paw_linkedlist.o                                                                              
 buffer_module.mod : ${OBJDIR}/paw_linkedlist.o                                                                                  
 energylist_module.mod : ${OBJDIR}/paw_lists.o                                                                                   
 grouplist_module.mod : ${OBJDIR}/paw_lists.o                                                                                    
 atomtypelist_module.mod : ${OBJDIR}/paw_lists.o                                                                                 
 ${OBJDIR}/paw_lock.o : clock_module.mod                                                                                         
 lock_module.mod : ${OBJDIR}/paw_lock.o                                                                                          
 ${OBJDIR}/paw_mixer.o : mpe_module.mod                                                                                          
 mixpulay_module.mod : ${OBJDIR}/paw_mixer.o                                                                                     
 mpi.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                                         
 mpe_mpif_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                             
 mpe_combine_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                          
 mpe_broadcast_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                        
 mpe_sendreceive_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                      
 mpe_send_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                             
 mpe_receive_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                          
 mpe_transpose_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                        
 mpe_gather_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                           
 mpe_module.mod : ${OBJDIR}/paw_mpelib${MODE}.o                                                                                  
 ${OBJDIR}/paw_occupations.o : restart_interface.mod                                                                             
 ${OBJDIR}/paw_occupations.o : mpe_module.mod                                                                                    
 ${OBJDIR}/paw_occupations.o : linkedlist_module.mod                                                                             
 dynocc_module.mod : ${OBJDIR}/paw_occupations.o                                                                                 
 occupation_module.mod : ${OBJDIR}/paw_occupations.o                                                                             
 optfric_module.mod : ${OBJDIR}/paw_optfric.o                                                                                    
 ${OBJDIR}/paw_optic.o : planewave_module.mod                                                                                    
 ${OBJDIR}/paw_optic.o : strings_module.mod                                                                                      
 ${OBJDIR}/paw_optic.o : atoms_module.mod                                                                                        
 ${OBJDIR}/paw_optic.o : setup_module.mod                                                                                        
 optic_module.mod : ${OBJDIR}/paw_optic.o                                                                                        
 ${OBJDIR}/paw_pairpotential.o : mpe_module.mod                                                                                  
 pdos_module.mod : ${OBJDIR}/paw_pdos.o                                                                                          
 ${OBJDIR}/paw_periodictable.o : strings_module.mod                                                                              
 periodictable_module.mod : ${OBJDIR}/paw_periodictable.o                                                                        
 ${OBJDIR}/paw_potential.o : mpe_module.mod                                                                                      
 ${OBJDIR}/paw_potential.o : periodictable_module.mod                                                                            
 potential_module.mod : ${OBJDIR}/paw_potential.o                                                                                
 ${OBJDIR}/paw_qmmm.o : periodictable_module.mod                                                                                 
 ${OBJDIR}/paw_qmmm.o : restart_interface.mod                                                                                    
 ${OBJDIR}/paw_qmmm.o : mpe_module.mod                                                                                           
 qmmm_module.mod : ${OBJDIR}/paw_qmmm.o                                                                                          
 ${OBJDIR}/paw_radial.o : periodictable_module.mod                                                                               
 radial_module.mod : ${OBJDIR}/paw_radial.o                                                                                      
 shlogradial_module.mod : ${OBJDIR}/paw_radial.o                                                                                 
 logradial_module.mod : ${OBJDIR}/paw_radial.o                                                                                   
 besseltransform_module.mod : ${OBJDIR}/paw_radial.o                                                                             
 restart_interface.mod : ${OBJDIR}/paw_report.o                                                                                  
 selftest_module.mod : ${OBJDIR}/paw_selftest.o                                                                                  
 ${OBJDIR}/paw_setupread.o : linkedlist_module.mod                                                                               
 setupread_module.mod : ${OBJDIR}/paw_setupread.o                                                                                
 ${OBJDIR}/paw_setups.o : periodictable_module.mod                                                                               
 setup_module.mod : ${OBJDIR}/paw_setups.o                                                                                       
 core_module.mod : ${OBJDIR}/paw_softcore.o                                                                                      
 clebsch_module.mod : ${OBJDIR}/paw_spherical.o                                                                                  
 sphericalccmat_module.mod : ${OBJDIR}/paw_spherical.o                                                                           
 ${OBJDIR}/paw_strcio.o : periodictable_module.mod                                                                               
 ${OBJDIR}/paw_strcio.o : strings_module.mod                                                                                     
 strcio_module.mod : ${OBJDIR}/paw_strcio.o                                                                                      
 strings_module.mod : ${OBJDIR}/paw_strings.o                                                                                    
 ${OBJDIR}/paw_thermostat.o : restart_interface.mod                                                                              
 ${OBJDIR}/paw_thermostat.o : mpe_module.mod                                                                                     
 thermostat_module.mod : ${OBJDIR}/paw_thermostat.o                                                                              
 ${OBJDIR}/paw_timing.o : mpe_module.mod                                                                                         
 timing_module.mod : ${OBJDIR}/paw_timing.o                                                                                      
 ${OBJDIR}/paw_trace.o : strings_module.mod                                                                                      
 trace_module.mod : ${OBJDIR}/paw_trace.o                                                                                        
 ${OBJDIR}/paw_usage.o : mpe_module.mod                                                                                          
 ${OBJDIR}/paw_vdw.o : constants_module.mod                                                                                      
 vdw_module.mod : ${OBJDIR}/paw_vdw.o                                                                                            
 ${OBJDIR}/paw_vext.o : periodictable_module.mod                                                                                 
 vext_module.mod : ${OBJDIR}/paw_vext.o                                                                                          
 warmup_module.mod : ${OBJDIR}/paw_warmup.o                                                                                      
 ${OBJDIR}/paw_waves1.o : linkedlist_module.mod                                                                                  
 ${OBJDIR}/paw_waves1.o : mpe_module.mod                                                                                         
 waves_module.mod : ${OBJDIR}/paw_waves1.o                                                                                       
 ${OBJDIR}/paw_waves2.o : mpe_module.mod                                                                                         
 ${OBJDIR}/paw_waves2.o : waves_module.mod                                                                                       
 ${OBJDIR}/paw_waves2.o : periodictable_module.mod                                                                               
 ${OBJDIR}/paw_waves2.o : restart_interface.mod                                                                                  
 wavesfixrho_module.mod : ${OBJDIR}/paw_waves2.o                                                                                 
 totalspin_module.mod : ${OBJDIR}/paw_waves2.o                                                                                   
 ${OBJDIR}/paw_waves_add.o : waves_module.mod                                                                                    
 ${OBJDIR}/paw_waves_add.o : mpe_module.mod                                                                                      
##########################################################################
#== machine-generated dependencies for the tools
###########################################################################
 ${OBJDIR}/build.o : strings_module.mod                                                                                          
 ${OBJDIR}/build.o : periodictable_module.mod                                                                                    
 ${OBJDIR}/paw_newatom.o : periodictable_module.mod                                                                              
 ${OBJDIR}/paw_newatom.o : linkedlist_module.mod                                                                                 
 ${OBJDIR}/paw_newatom.o : strings_module.mod                                                                                    
 broyden_module.mod : ${OBJDIR}/paw_newatom.o                                                                                    
 ${OBJDIR}/paw_atom.o : strings_module.mod                                                                                       
 ${OBJDIR}/paw_atom.o : linkedlist_module.mod                                                                                    
 ${OBJDIR}/paw_atom.o : periodictable_module.mod                                                                                 
 ${OBJDIR}/paw_atom.o : schrgl_interface_module.mod                                                                              
 grid.mod : ${OBJDIR}/paw_atom.o                                                                                                 
 aeatom.mod : ${OBJDIR}/paw_atom.o                                                                                               
 projection.mod : ${OBJDIR}/paw_atom.o                                                                                           
 ${OBJDIR}/paw_atom.o : strings_module.mod                                                                                       
 ${OBJDIR}/paw_atom.o : linkedlist_module.mod                                                                                    
 ${OBJDIR}/paw_atom.o : periodictable_module.mod                                                                                 
 ${OBJDIR}/paw_atom.o : schrgl_interface_module.mod                                                                              
 grid.mod : ${OBJDIR}/paw_atom.o                                                                                                 
 aeatom.mod : ${OBJDIR}/paw_atom.o                                                                                               
 projection.mod : ${OBJDIR}/paw_atom.o                                                                                           
 schrgl_interface_module.mod : ${OBJDIR}/paw_diffgl.o                                                                            
 besseltransform_module.mod : ${OBJDIR}/paw_oldradial.o                                                                          
 ${OBJDIR}/paw_grab.o : linkedlist_module.mod                                                                                    
 ${OBJDIR}/paw_grab.o : strings_module.mod                                                                                       
 substance_module.mod : ${OBJDIR}/paw_grab.o                                                                                     
 readcntl_module.mod : ${OBJDIR}/paw_grab.o                                                                                      
 ${OBJDIR}/paw_dos.o : pdos_module.mod                                                                                           
 ${OBJDIR}/paw_dos.o : strings_module.mod                                                                                        
 ${OBJDIR}/paw_dos.o : linkedlist_module.mod                                                                                     
 spindir_module.mod : ${OBJDIR}/paw_dos.o                                                                                        
 orbitals_module.mod : ${OBJDIR}/paw_dos.o                                                                                       
 readcntl_module.mod : ${OBJDIR}/paw_dos.o                                                                                       
 ${OBJDIR}/paw_preopt.o : linkedlist_module.mod                                                                                  
 ${OBJDIR}/paw_preopt.o : strings_module.mod                                                                                     
 ${OBJDIR}/paw_preopt.o : periodictable_module.mod                                                                               
 popt_module.mod : ${OBJDIR}/paw_preopt.o                                                                                        
 read_module.mod : ${OBJDIR}/paw_preopt.o                                                                                        
 ${OBJDIR}/paw_strc.o : linkedlist_module.mod                                                                                    
 ${OBJDIR}/paw_strc.o : strings_module.mod                                                                                       
 ${OBJDIR}/paw_tostrc.o : linkedlist_module.mod                                                                                  
 ${OBJDIR}/paw_tostrc.o : strings_module.mod                                                                                     
 ${OBJDIR}/paw_tostrc.o : periodictable_module.mod                                                                               
 ${OBJDIR}/paw_tostrc.o : forcefield_module.mod                                                                                  
 ${OBJDIR}/paw_toxyz.o : linkedlist_module.mod                                                                                   
 ${OBJDIR}/paw_toxyz.o : strings_module.mod                                                                                      
 ${OBJDIR}/paw_tozyz.o : linkedlist_module.mod                                                                                   
 ${OBJDIR}/paw_tozyz.o : strings_module.mod                                                                                      
 ${OBJDIR}/paw_cleantra.o : strings_module.mod                                                                                   
 ${OBJDIR}/paw_cleantra.o : linkedlist_module.mod                                                                                
 ${OBJDIR}/paw_tra.o : strings_module.mod                                                                                        
 ${OBJDIR}/paw_tra.o : linkedlist_module.mod                                                                                     
 ${OBJDIR}/paw_tra.o : sort_module.mod                                                                                           
 ${OBJDIR}/paw_tra.o : periodictable_module.mod                                                                                  
 ${OBJDIR}/paw_tra.o : forcefield_module.mod                                                                                     
 trajectory_module.mod : ${OBJDIR}/paw_tra.o                                                                                     
 ${OBJDIR}/paw_wave.o : strings_module.mod                                                                                       
 ${OBJDIR}/paw_wave.o : linkedlist_module.mod                                                                                    
 ${OBJDIR}/paw_wave.o : periodictable_module.mod                                                                                 



